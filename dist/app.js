!function(t){var e={};function n(s){if(e[s])return e[s].exports;var r=e[s]={i:s,l:!1,exports:{}};return t[s].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=t,n.c=e,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(s,r,function(e){return t[e]}.bind(null,r));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(t,e,n){var s=n(1),r=n(2);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[t.i,r,""]]);var o={insert:"head",singleton:!1};s(r,o);t.exports=r.locals||{}},function(t,e,n){"use strict";var s,r=function(){return void 0===s&&(s=Boolean(window&&document&&document.all&&!window.atob)),s},o=function(){var t={};return function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}t[e]=n}return t[e]}}(),a=[];function i(t){for(var e=-1,n=0;n<a.length;n++)if(a[n].identifier===t){e=n;break}return e}function l(t,e){for(var n={},s=[],r=0;r<t.length;r++){var o=t[r],l=e.base?o[0]+e.base:o[0],c=n[l]||0,u="".concat(l," ").concat(c);n[l]=c+1;var h=i(u),d={css:o[1],media:o[2],sourceMap:o[3]};-1!==h?(a[h].references++,a[h].updater(d)):a.push({identifier:u,updater:g(d,e),references:1}),s.push(u)}return s}function c(t){var e=document.createElement("style"),s=t.attributes||{};if(void 0===s.nonce){var r=n.nc;r&&(s.nonce=r)}if(Object.keys(s).forEach((function(t){e.setAttribute(t,s[t])})),"function"==typeof t.insert)t.insert(e);else{var a=o(t.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(e)}return e}var u,h=(u=[],function(t,e){return u[t]=e,u.filter(Boolean).join("\n")});function d(t,e,n,s){var r=n?"":s.media?"@media ".concat(s.media," {").concat(s.css,"}"):s.css;if(t.styleSheet)t.styleSheet.cssText=h(e,r);else{var o=document.createTextNode(r),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(o,a[e]):t.appendChild(o)}}function m(t,e,n){var s=n.css,r=n.media,o=n.sourceMap;if(r?t.setAttribute("media",r):t.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(s+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleSheet)t.styleSheet.cssText=s;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(s))}}var p=null,v=0;function g(t,e){var n,s,r;if(e.singleton){var o=v++;n=p||(p=c(e)),s=d.bind(null,n,o,!1),r=d.bind(null,n,o,!0)}else n=c(e),s=m.bind(null,n,e),r=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)};return s(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;s(t=e)}else r()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=r());var n=l(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var s=0;s<n.length;s++){var r=i(n[s]);a[r].references--}for(var o=l(t,e),c=0;c<n.length;c++){var u=i(n[c]);0===a[u].references&&(a[u].updater(),a.splice(u,1))}n=o}}}},function(t,e,n){},function(t,e,n){"use strict";n.r(e);n(0);class s{constructor(t=null){this.rootElement=t,this.rootId="root"}init(){return null===this.rootElement&&(this.rootElement=document.querySelector("#"+this.rootId)),this}removeChildrenInRoot(){var t;if(null===this.rootElement)throw Error("ROOT element is null; check correct id name");for(;null===(t=this.rootElement)||void 0===t?void 0:t.firstChild;)this.rootElement.removeChild(this.rootElement.firstChild)}add(t){var e;this.removeChildrenInRoot(),null===(e=this.rootElement)||void 0===e||e.appendChild(t.getTree().value)}}function r(t){return null==t||!t||(!(!Array.isArray(t)||0!==t.length)||("string"==typeof t&&0===t.length||!!("object"==typeof t&&t&&Object.keys(t).length<1)))}function o(t,e=null){if(null===e)return t.trim();const n=new Set(e),s=()=>{let t=!1;return(e,s)=>(!t&&n.has(s)||(t=!0,e.push(s)),e)};return t.split("").reduce(s(),[]).reduceRight(s(),[]).reverse().join("")}function a(t){return"object"==typeof t&&null!==t}function i(t,e,n){if(!e)throw Error("Empty path in Get method");const s=e.split(".");if(!a(t))return n;let r=t;for(const t of s)if(r=r[t],void 0===r)return n;return r||n}class l{constructor(t=null,e=class{constructor(t,e,n,s,r){this.pathname=t,this.componentClass=e,this.props=n,this.componentList=s,this.middlewares=r,this._block=null}getPathname(){return this.pathname}leave(){this._block&&(this._block.detachComponent(),this._block=null)}match(t){const e=this.pathname.match(/{:([\w])*}/);if(null===e||0===e.length)return function t(e,n){if(e===n)return!0;const s=t=>"object"==typeof t&&null!==t&&"toString"in t;if(s(e)&&!s(n)||!s(e)&&s(n))return!1;if(s(e)&&s(n)){let r=!0;for(const[o,a]of Object.entries(e)){if(!r)break;if("object"==typeof n&&null!==n&&!n.hasOwnProperty(o)){r=!1;break}r=s(a)&&s(n)?t(a,n[o]):a===n[o]}return r}return e===n}(t,this.pathname);{const e=t.split("/"),n=this.pathname.split("/");if(e.length!==n.length)return!1;for(let t=0;t<n.length;t+=1){const s=n[t].match(/{:([\w])*}/);if((null===s||0===s.length)&&n[t].trim()!==e[t].trim())return!1}return!0}}async checkMiddleware(){for(const t of this.middlewares){const e=await t.process();if(!e.state)return{state:e.state,redirectUrl:e.route}}return{state:!0,redirectUrl:""}}render(t={}){this._block||(this._block=new this.componentClass(Object.assign(Object.assign({},this.props),t),this.componentList)),(new s).init().add(this._block)}},n=window){if(this.historyObject=t,this.RouteClass=e,this.browserWindow=n,this.routes=[],this.currentRoute=null,this.errorRoute=null,this.prevPathName="",l.__instance)return l.__instance;l.__instance=this}use(t,e,n={},s,r=[]){const o=new this.RouteClass(t,e,n,s,r);return this.routes.push(o),this}useOnError(t,e,n,s=[]){return this.errorRoute=new this.RouteClass("",t,e,n,s),this}start(){var t,e;this.browserWindow.onpopstate=t=>{if(t.currentTarget){const e=t.currentTarget;this._onRoute(e.location.pathname).catch(console.log)}};let n={};const s=this.getRoute(window.location.pathname);s&&this.patternExist(null!==(t=null==s?void 0:s.getPathname())&&void 0!==t?t:"")&&(n=null!==(e=this.getParamsFromPathname(window.location.pathname,s.getPathname()))&&void 0!==e?e:{}),this._onRoute(window.location.pathname,n).catch(console.log)}renderNotFoundRoute(){var t,e;this.currentRoute&&this.currentRoute.leave(),this.currentRoute=this.errorRoute;null===(t=this.errorRoute)||void 0===t||t.render({errorCode:"404",errorMessage:"Уупппс, ничего не найдено :("}),null===(e=this.historyObject)||void 0===e||e.pushState({},"","/404")}async _onRoute(t,e={}){var n;let s=this.getRoute(t);if(!s)return this.renderNotFoundRoute();const r=await s.checkMiddleware();if(!r.state){const t=this.getRoute(r.redirectUrl);if(!t)return this.renderNotFoundRoute();s=t,null===(n=this.historyObject)||void 0===n||n.pushState({},"",r.redirectUrl)}s===this.currentRoute&&t===this.prevPathName||(this.currentRoute&&this.currentRoute.leave(),this.currentRoute=s,this.prevPathName=t,s.render(e))}go(t,e={}){if(this.patternExist(t)){if(r(e))throw Error("empty props, but required => "+t);t=this.matchPathnameWithParams(t,e)}this.historyObject&&(this.historyObject.pushState({},"",t),this._onRoute(t,e).catch(console.log))}matchPathnameWithParams(t,e){const n=t.match(/{:([\w])*}/gm);return null===n||n.forEach(n=>{const s=o(n,"{}: "),r=String(i(e,s));t=t.replace(n,r)}),t}getParamsFromPathname(t,e){const n=t.split("/"),s=e.split("/"),r={};if(n.length!==s.length)return null;for(let t=0;t<n.length;t+=1)if(this.patternExist(s[t])){r[o(s[t],"{}:' ")]=n[t]}return r}patternExist(t){const e=t.match(/{:([\w])*}/);return null!==e&&e.length>0}back(){this.historyObject&&this.historyObject.back()}forward(){this.historyObject&&this.historyObject.forward()}getRoute(t){return this.routes.find(e=>e.match(t))}}const c=new l(window.history);class u{constructor(t){this._value=t,this._parent=null,this._childrens=[],this._fragmentChildrens=[]}get value(){return this._value}get childrens(){return this._childrens}set childrens(t){this._childrens=t}get fragmentChildrens(){return this._fragmentChildrens}get parent(){return this._parent}set parent(t){this._parent=t}setParent(t){this._parent=t}static getParent(t){return null===t._parent?t:this.getParent(t._parent)}}class h{constructor(){this.tail=null,this._size=0}push(t){const e={value:t,next:null,prev:null};return 0===this._size||(null!==this.tail&&(this.tail.next=e),e.prev=this.tail),this.tail=e,++this._size}isEmptyStack(){return 0===this._size}pop(){if(this.isEmptyStack()||null===this.tail)throw Error("stack is empty");const t=this.tail;return this.tail=this.tail.prev,this.tail&&(this.tail.next=null),this._size-=1,t.value}peek(){if(this.isEmptyStack()||null===this.tail)throw Error("stack is empty");return this.tail.value}size(){return this._size}}const d=new Set(["div","span","li","ul","a","h1","h2","h3","h4","h5","h6","section","nav","header","footer","table","input","form","textarea","button","i","b","p","br","small"]),m=new Set(["input","hr","br"]);var p;!function(t){t[t.FRAGMENT=11]="FRAGMENT"}(p||(p={}));class v{constructor(t,e){this.template=t,this.componentList=e,this._propPattern=/\{\{(.*?)\}\}/gi,this._attrPattern=/[A-Za-z-]+\=\"(.*?)\"/gi,this._tagPattern=/<\/?[^>]+(>|$)/g,this._childrenComponents=[]}compile(t){const e=this.prepareTemplate(this.template.trim(),t),n=e.match(this._tagPattern);if(null===n||0===n.length)return{tree:new u(this.createTextElement(e)),childrenComponents:[]};const s=new h;let r=new u(document.createDocumentFragment()),o=[];for(const a of n){const n=this._tagPattern.exec(e);if(null===n)throw Error(`Ooops, something wrong in Templator => "${e}"`);if(this.isComponentTagName(a)){const e=this.createComponentTree(a,t);null!==e&&(r.value.nodeType===p.FRAGMENT&&r.fragmentChildrens.push(e),r.childrens.push(e),e.setParent(r),r.value.appendChild(e.value))}else if(this.isCloseTagName(a)){if(0===s.size())throw Error(`Stack is EMPTY => ${e}; || ${a}; || ${o};`);s.pop();const t=this.getTextNodeBetweenTag(e,o,n);if(null!==t&&null!==r){r.value.appendChild(t);const e=new u(t);r.value.nodeType===p.FRAGMENT&&r.fragmentChildrens.push(e),r.childrens.push(e),e.setParent(r)}null!==r&&(null==r?void 0:r.parent)&&(r=null==r?void 0:r.parent)}else{if(0!==s.size()){const t=this.getTextNodeBetweenTag(e,o,n);if(null!==t&&null!==r){r.value.appendChild(t);const e=new u(t);r.childrens.push(e),r.value.nodeType===p.FRAGMENT&&r.fragmentChildrens.push(e),e.setParent(r)}}const t=this.createHtmlElement(n[0]);if(null===r)r=new u(t);else{const e=new u(t);e.setParent(r),r.childrens.push(e),r.value.nodeType===p.FRAGMENT&&r.fragmentChildrens.push(e),r.value.appendChild(e.value),this.isAutoCloseTag(n[0])||(r=e)}this.isAutoCloseTag(n[0])||s.push(n)}o=n}return{tree:r,childrenComponents:this._childrenComponents}}textExistBetweenTag(t,e){return!this.isCloseTagName(t[0])&&!this.isCloseTagName(e[0])||null!==t&&this.isCloseTagName(t[0])&&!this.isCloseTagName(e[0])||null!==t&&this.isCloseTagName(t[0])&&this.isCloseTagName(e[0])||!this.isCloseTagName(t[0])}isAutoCloseTag(t){const e=this.getComponentName(t);return m.has(e)}getTextNodeBetweenTag(t,e,n){var s;if(!this.textExistBetweenTag(e,n))return null;const r=t.slice((null!==(s=e.index)&&void 0!==s?s:0)+e[0].length,n.index).trim();return r.length>0?this.createTextElement(r):null}isCloseTagName(t){return 0!==t.length&&t.trim().slice(1,3).includes("/")}getComponentName(t){return o(t,"<>\\//").split(" ")[0].trim()}isComponentTagName(t){const e=this.getComponentName(o(t,"*.<>//\\'\" "));return!d.has(e)}createComponentTree(t,e){var n,s;const r=this.getComponentName(t),o=null!==(n=i(e,r,null))&&void 0!==n?n:null===(s=this.componentList.find(t=>t.name===r))||void 0===s?void 0:s.value;if(null===o)throw Error("Component do not get :(");if(!o)throw Error("Unknown Component -> "+r);const a=new o(this.createPropsByString(t,e),this.componentList);return this._childrenComponents.push(a),a.getTree()}createPropsByString(t,e){const n=o(t,"<>//\\").match(this._attrPattern);if(!n||0===n.length)return{};const s={};for(const t of n){const[n,r]=t.split("=");r.includes("**")&&r.includes("**")?s[n]=i(e,o(r,"* <>//\\'{}\" ")):s[n]=this.typeOfValue(o(r,"'\"<>//\\* "))}return s}typeOfValue(t){return"true"===t||"false"!==t&&("null"===t?null:"undefined"!==t?t:void 0)}getAttrList(t){const e=o(t,"<>//\\").match(this._attrPattern);if(null===e||0===e.length)return[];const n=[];return e.forEach(t=>{const[e,s]=t.split("="),r=o(s," \\//<>=.'\"");"null"!==r&&"undefined"!==r&&n.push({name:o(e," \\//<>=."),value:r})}),n}createHtmlElement(t,e=null){const n=this.getComponentName(t);try{const s=document.createElement(n),r=this.getAttrList(t);return r.length&&r.forEach(({value:t,name:e})=>{"className"===e?s.classList.add(...t.split(" ").map(t=>o(t," '\"*<>//\\"))):s.setAttribute(e,t)}),null!==e&&s.appendChild(s),s}catch(t){return{textContent:"HTML_ELEMENT => "+n,appendChild:t=>t}}}createTextElement(t){try{return document.createTextNode(t)}catch(e){return{textContent:t,appendChild:t=>t}}}prepareTemplate(t,e){let n=null;const s=this._propPattern;for(;n=s.exec(t);)if(n[1]){const s=i(e,n[1].trim(),"null");"string"!=typeof s&&"number"!=typeof s&&"boolean"!=typeof s||(t=t.replace(new RegExp(n[0],"gi"),String(s))),Array.isArray(s)&&(t=t.replace(new RegExp(n[0],"gi"),s.join("")))}return t}}class g{constructor(){this.listeners={}}emit(t,...e){return Array.isArray(this.listeners[t])&&this.listeners[t].forEach(t=>{t(...e)}),this}emitAsync(t,...e){return setTimeout(()=>this.emit(t,...e),0),this}on(t,e){void 0===this.listeners[t]&&(this.listeners[t]=[]);return this.listeners[t].find(t=>t===e)||this.listeners[t].push(e),this}off(t,e){return Array.isArray(this.listeners[t])&&(this.listeners[t]=this.listeners[t].filter(t=>t!==e)),this}}class f{constructor(t,e){this.prevTree=t,this.nextTree=e}init(){this.cleanFragmentNodes(this.prevTree),this.cleanFragmentNodes(this.nextTree),this.compareAndCommit(this.prevTree,this.nextTree)}getParent(t){const e=t.parent;return e?11!==e.value.nodeType?e:this.getParent(e):t}cleanFragmentNodes(t){if(t.parent&&11===t.parent.value.nodeType){const e=this.getParent(t);e&&(e.childrens=e.childrens.filter(e=>t.parent!==e&&e!==t),e.childrens.push(t),t.parent=e)}t.childrens.forEach(t=>this.cleanFragmentNodes(t))}swapChild(t,e){for(;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild.cloneNode(!0)),e.removeChild(e.firstChild)}compareAndCommit(t,e){const n=t.value,s=e.value;if([11,3].includes(n.nodeType)||[11,3].includes(s.nodeType)||n.nodeName!==s.nodeName||this.copyAttributes(n,s),0===t.childrens.length&&0===e.childrens.length)t.value.textContent!==e.value.textContent&&(t.value.textContent=e.value.textContent);else if(t.childrens.length!==e.childrens.length)this.swapChild(n,s),t.childrens=e.childrens;else if(t.childrens.length===e.childrens.length){let n=!1;for(let s=0;s<t.childrens.length;s+=1)if(11!==t.childrens[s].value.nodeType&&11!==e.childrens[s].value.nodeType&&t.childrens[s].value.nodeName!==e.childrens[s].value.nodeName){this.swapChild(t.value,e.value),t.childrens=e.childrens,n=!0;break}if(!n)for(let n=0;n<t.childrens.length;n+=1)this.compareAndCommit(t.childrens[n],e.childrens[n])}}copyAttributes(t,e){try{e.getAttributeNames().forEach(n=>{const s=e.getAttribute(n);null!==s?t.setAttribute(n,s):t.removeAttribute(n)})}catch(n){console.log(e.nodeType),console.log(t)}}}class _{constructor(t={},e=[]){this._childrenComponents=[],this.componentDelete=!1,this.eventBus=new g,this._props=_.proxyfyProps(t),this._componentList=e,this._parentElement=null,this._componentTree=null,this.registerEvents(),this.eventBus.emit("init")}registerEvents(){this.eventBus.on("init",this.init.bind(this)),this.eventBus.on("flow:render",this._render.bind(this)),this.eventBus.on("flow:component-did-mount",this._componentDidMount.bind(this)),this.eventBus.on("flow:component-did-update",this._componentDidUpdate.bind(this)),this.eventBus.on("flow:component-will-unmount",this._componentWillUnmount.bind(this))}init(){this.eventBus.emit("flow:render"),this.eventBus.emitAsync("flow:component-did-mount")}_componentDidMount(){this.componentDidMount(this.props)}componentDidMount(t){}_componentDidUpdate(t,e){this.componentDidUpdate(t,e)}componentDidUpdate(t,e){}_componentWillUnmount(){this.componentDelete=!0,this._childrenComponents.forEach(t=>{t._componentWillUnmount&&t._componentWillUnmount()}),this.componentWillUnmount(this._props)}componentWillUnmount(t){}_componentWillUpdate(t,e){this.componentWillUpdate(t,e)?(Object.assign(this.props,e),this.eventBus.emit("flow:render",!0),this.eventBus.emitAsync("flow:component-did-update",t,e)):console.log("-------------------\x3e sss")}componentWillUpdate(t,e){return!0}get props(){return this._props}get componentList(){return this._componentList}getComponent(){return this.componentList}setProps(t){t&&a(t)&&this._componentWillUpdate(this.props,t)}getTree(){if(null===this._componentTree)throw Error("Component tree is null");return this._componentTree}_render(t=!1){t&&this._childrenComponents.forEach(t=>{t._componentWillUnmount&&t._componentWillUnmount()});const{tree:e,childrenComponents:n}=new v(this.render(),this.componentList).compile(this.props);if(!e)throw Error("Component tree did not get");return this._componentTree?new f(this._componentTree,e).init():(this._componentTree=e,this._parentElement=u.getParent(this._componentTree).value),this._childrenComponents=n,this._componentTree}detachComponent(){var t;this.eventBus.emit("flow:component-will-unmount");const e=null===(t=this._parentElement)||void 0===t?void 0:t.parentElement;e&&null!==this._parentElement&&e.removeChild(this._parentElement)}render(){throw Error("method do not implement")}static proxyfyProps(t){return new Proxy(t,{set:(t,e,n)=>(t[e]=n,!0)})}}class b{static saveItemByKey(t,e){b.storageSource.setItem(t,e)}static getItemByKey(t){const e=b.storageSource.getItem(t);return e||null}static removeItemByKey(t){b.storageSource.removeItem(t)}static getObjectByKey(t){const e=b.getItemByKey(t);if(!e)return null;const n=JSON.parse(e);return n||null}}b.storageSource=window.localStorage;class C{static authorize(t){b.saveItemByKey(C.userStorageKey,JSON.stringify(t))}static removeUser(){C.userExist()&&b.removeItemByKey(C.userStorageKey)}static userExist(){return null!==C.getUser()}static getUser(){return b.getObjectByKey(C.userStorageKey)}}C.userStorageKey="user_data";const y="GET",w="PUT",E="POST",N="DELETE";class T{constructor(t=XMLHttpRequest){this.API=t,this.get=(t,e={})=>this.request(t,Object.assign(Object.assign({},e),{method:y}),e.timeout),this.put=(t,e={})=>this.request(t,Object.assign(Object.assign({},e),{method:w}),e.timeout),this.post=(t,e={})=>this.request(t,Object.assign(Object.assign({},e),{method:E}),e.timeout),this.delete=(t,e={})=>this.request(t,Object.assign(Object.assign({},e),{method:N}),e.timeout),this.request=(t,e={},n=5e3)=>new Promise((s,r)=>{try{const o=new this.API;if(!e.method)throw Error("method is required");if(e.method===y){const n=`${t}${function(t={}){let e="?";if("object"!=typeof t)return"";const n=Object.entries(t);return 0===n.length?"":(n.forEach(([t,n],s,r)=>{Array.isArray(n)?e+=`${t}=${n.join(",")}`:e+=`${t}=${n}`,s+1!==r.length&&(e+="&")}),e)}(e.data)}`;o.open(e.method,n)}else o.open(e.method,t);e.header&&Object.keys(e.header).forEach(t=>{e&&e.header&&o.setRequestHeader(t,String(e.header[t]))}),o.setRequestHeader&&!e.isFormData&&o.setRequestHeader("content-type","application/json"),o.withCredentials=!0;let a=!0;e.method===y?o.send():e.isFormData?o.send(e.data):o.send(JSON.stringify(e.data));const i=setTimeout(()=>{a=!1,r({error:"timeout"})},n);o.onload=()=>{a&&(clearTimeout(i),s(o))},o.onabort=r,o.onerror=r,o.ontimeout=r}catch(t){r(t)}})}}const A="https://ya-praktikum.tech",L={AUTHORIZATION:{url:A+"/api/v2/auth/signin",method:"POST"},REGISTRATION:{url:A+"/api/v2/auth/signup",method:"POST"},CHECK_AUTH:{url:A+"/api/v2/auth/user",method:"GET"},LOGOUT:{url:A+"/api/v2/auth/logout",method:"POST"},UPDATE_USER:{url:A+"/api/v2/user/profile",method:"PUT"},UPDATE_AVATAR:{url:A+"/api/v2/user/profile/avatar",method:"PUT"},UPDATE_PASSWORD:{url:A+"/api/v2/user/password",method:"PUT"},CREATE_CHAT:{url:A+"/api/v2/chats",method:"POST"},GET_CHATS:{url:A+"/api/v2/chats",method:"GET"},GET_CHAT_USERS:{url:A+"/api/v2/chats",method:"GET",urlTemplate:t=>`${A}/api/v2/chats/${t}/users`},GET_CHAT_COUNT_MESSAGE:{url:A+"/api/v2/chats",method:"GET",urlTemplate:t=>`${A}/api/v2/chats/new/${t}`},DELETE_USER_FROM_CHAT:{url:A+"/api/v2/chats/users",method:"DELETE"},ADD_USER_IN_CHAT:{url:A+"/api/v2/chats/users",method:"PUT"},FIND_USER_BY_LOGIN:{url:A+"/api/v2/user/search",method:"POST"}};class O{constructor(t){this.chatId=t}async perform(){try{const t=await(new T).get(L.GET_CHAT_COUNT_MESSAGE.urlTemplate?L.GET_CHAT_COUNT_MESSAGE.urlTemplate(this.chatId):L.GET_CHAT_COUNT_MESSAGE.url);if(t.status>=400)return{state:!1,errors:[{message:t.response}]};const e=JSON.parse(t.response);if(!e||void 0===e.unread_count)throw Error("JSON parse error in GetUnreadMessages");return{state:!0,count:e.unread_count,errors:[]}}catch(t){return console.log(t),{state:!1,errors:[{message:"Ууппс, что-то пошло не так"}]}}}}class S{async perform(){try{const t=await(new T).get(L.GET_CHATS.url);if(t.status>=400)return{state:!1,errors:[{message:"Сервер не доступен :("}]};const e=JSON.parse(t.response);if(!e)throw Error("error in JSON parse");const n=[];for(const t of e){const e=await new O(t.id).perform();if(!e.state)throw e.errors;n.push({id:t.id,avatar:t.avatar,title:t.title,unreadMessage:e.count?e.count:0,users:[]})}return{state:!0,chats:n.reverse(),errors:[]}}catch(t){return{state:!1,errors:[]}}}}function x(t){const e={};return t.forEach(({field:t,message:n})=>{t?e[t]=n:e.default=n}),e}class P{static addChats(t){b.saveItemByKey(P.chatStorageKey,JSON.stringify(t))}static cleanChats(){b.removeItemByKey(P.chatStorageKey)}static getChats(){return b.getObjectByKey(P.chatStorageKey)}}async function I(){try{const t=await(new S).perform();if(!t.state)throw x(t.errors);return P.cleanChats(),t.chats&&P.addChats(t.chats),!0}catch(t){return Object.keys(t).forEach(e=>{alert(t[e])}),!1}}P.chatStorageKey="user_chats";class U{constructor(t){this.chatName=t}async perform(){try{const t=await(new T).post(L.CREATE_CHAT.url,{data:{title:this.chatName}});return t.status>=400?{state:!1,errors:[{message:t.response}]}:{state:!0,errors:[]}}catch(t){return console.log(t),{state:!1,errors:[{message:"Уууппс, что-то пошло не так :( "}]}}}}const k=/^[A-Za-zа-яёА-ЯЁ]+$/,B=["дурак","идиот"];function R(t){return"string"==typeof t}function j(t){return function(t){return Object.prototype.toString.call(t).includes("Map")}(t)||function(t){return Object.prototype.toString.call(t).includes("Set")}(t)||R(t)||Array.isArray(t)||"object"==typeof t&&null!==t&&"length"in t}class F{constructor(t,e){this.field=t,this.value=e,this.errors={}}static validate(t,e){const n={errors:{},hasError:!1},s=Object.entries(t),r=Object.keys(e);for(const[t,o]of s){if(!r.includes(t))continue;const s=new F(t,e[t]);for(const t of o.rules){const e=t.split(":")[0],n=t.split(":")[1],r=s.getFnByName(e);"function"==typeof r&&r(n)}s.hasError&&(n.hasError=!0,n.errors=Object.assign(Object.assign({},n.errors),s.errors))}return n}static get rules(){return{maxLength:"_maxLength",minLength:"_minLength",onlyLetters:"_onlyLetters",noBadWords:"_noBadWords",required:"_required"}}getFnByName(t){switch(t){case"_maxLength":return this._maxLength.bind(this);case"_minLength":return this._minLength.bind(this);case"_onlyLetters":return this._onlyLetters.bind(this);case"_noBadWords":return this._noBadWords.bind(this);case"_required":return this._required.bind(this);default:throw Error(`unknown function name = ${t}, in Validator`)}}get hasError(){return Object.keys(this.errors).length>0}_maxLength(t){if(this.hasError)return this;return!(j(this.value)&&this.value.length<=t)&&(this.errors[this.field]=`Длина поля превышает ${t} символов`),this}_minLength(t){if(this.hasError)return this;return!(j(this.value)&&this.value.length>=t)&&(this.errors[this.field]=`Длина поля должна быть больше ${t} символов`),this}_required(){return this.hasError||r(this.value)&&(this.errors[this.field]="Поле обязательно для заполнения"),this}_onlyLetters(){return this.hasError||R(t=this.value)&&!r(t)&&t.match(k)||(this.errors[this.field]="Поле должно содержать только буквы"),this;var t}_noBadWords(){return this.hasError||R(t=this.value)&&!r(t)&&0!==[...B].filter(e=>t.includes(e)).length&&(this.errors[this.field]="У нас тут культурное общество, не используется брань!"),this;var t}}class D{constructor(){this._rules=[]}static init(){return new D}get rules(){return this._rules}maxLength(t){return this.rules.push(`${F.rules.maxLength}:${t}`),this}minLength(t){return this.rules.push(`${F.rules.minLength}:${t}`),this}required(){return this.rules.push(F.rules.required+":true"),this}onlyLetters(){return this.rules.push(F.rules.onlyLetters+":true"),this}noBadWords(){return this.rules.push(F.rules.noBadWords+":true"),this}}function M(t){return F.validate({login:D.init().required().maxLength(25).minLength(4).noBadWords(),name:D.init().required().maxLength(25).minLength(3).onlyLetters().noBadWords(),surname:D.init().required().maxLength(25).minLength(3).onlyLetters().noBadWords(),phone:D.init().required().maxLength(20).minLength(8),email:D.init().maxLength(22).minLength(3).required(),bio:D.init().maxLength(255),password:D.init().required().minLength(5).maxLength(16),chatName:D.init().required().minLength(5).maxLength(58).noBadWords(),userLogin:D.init().required().minLength(4).maxLength(35)},t)}class $ extends _{constructor(t={},e){super(Object.assign(Object.assign({},$.defaultProps),t),e),this.onCreateChatClick=this.onCreateChatClick.bind(this)}componentDidMount(){Promise.all([this.updatePersonDataInMenu(),this.loadContacts()]).then(([t,e])=>{const n=this.props.menuData;this.setProps({menuData:Object.assign(Object.assign({},n),t),contactsData:{contactsList:e},isLoadingContactsList:!1}),this.initCreateChatEvent()}).catch(t=>{console.log("error in messenger => ",t)})}componentWillUpdate(){return this.destroyCreateChatEvent(),!0}componentDidUpdate(){this.destroyCreateChatEvent(),this.initCreateChatEvent()}componentWillUnmount(){this.destroyCreateChatEvent()}initCreateChatEvent(){const t=document.querySelector("#"+this.props.createChatButtonId);t&&t.addEventListener("click",this.onCreateChatClick)}destroyCreateChatEvent(){const t=document.querySelector("#"+this.props.createChatButtonId);t&&t.removeEventListener("click",this.onCreateChatClick)}loadContacts(){return I().then(t=>{var e;return t&&null!==(e=P.getChats())&&void 0!==e?e:[]})}updatePersonDataInMenu(){var t;const e=C.getUser();e||c.go("/login");const n=r(null==e?void 0:e.name)?"[Укажите имя]":null==e?void 0:e.name,s=r(null==e?void 0:e.surname)?"[Укажите фамилию]":null==e?void 0:e.surname,o=null!==(t=null==e?void 0:e.avatar)&&void 0!==t?t:"";return n&&s?{userName:n,userSurname:s,userAvatar:o}:null}onCreateChatClick(){const t=document.querySelector("#"+this.props.createChatInputId);if(!t)return;const e=M({chatName:t.value});e.hasError?Object.keys(e.errors).forEach(t=>{alert(e.errors[t])}):(this.setProps({isLoadingContactsList:!0}),async function(t){try{const e=await new U(t).perform();if(!e.state)throw x(e.errors);return!0}catch(t){return Object.keys(t).forEach(e=>{alert(t[e])}),!1}}(t.value).then(t=>!!t&&I()).then(t=>{setTimeout(()=>{t?this.setProps({isLoadingContactsList:!1,contactsData:{contactsList:P.getChats()}}):this.setProps({isLoadingContactsList:!1})},10)}))}render(){return'\n      <Menu\n        logoutUrl="**menuData.logoutUrl**"\n        menuList="**menuData.menuList**"\n        userName="**menuData.userName**"\n        userSurname="**menuData.userSurname**"\n        userAvatar="**menuData.userAvatar**"\n      />\n      <section class="left-aside">\n        <ContactSearch />\n         \n        <div class="contacts">\n          <ContactsList\n            createChatId="{{ createChatButtonId }}"\n            createChatInputId="{{ createChatInputId }}"\n            contactsList="**contactsData.contactsList**"\n            isLoading="{{ isLoadingContactsList }}"\n          /> \n        </div>\n      </section>\n      \n      <Conversation />\n    '}}$.defaultProps={isLoadingContactsList:!0,contactsData:{contactsList:[]},menuData:{userName:"Loading...",userSurname:"Loading...",userAvatar:"",logoutUrl:"/logout",menuList:[{text:"Мессенджер",url:"/"},{text:"Профиль",url:"/settings"},{text:"Авторизация",url:"/login"},{text:"Регистрация",url:"/register"}]},createChatButtonId:"create-chat-button-id",createChatInputId:"create-chat-input-id",chatId:null,chatOpen:!1};class q extends _{constructor(t,e){super(Object.assign(Object.assign({},q.defaultProps),t),e),this._buttonElement=null}setClickEvent(t){if(null!==t.onClick&&null!==t.buttonId){if(this._buttonElement=document.getElementById(t.buttonId),null===this._buttonElement)throw Error("incorrect Button id => "+t.buttonId);this._buttonElement.addEventListener("click",t.onClick)}}componentDidMount(t){this.setClickEvent(t)}componentDidUpdate(t,e){this.setClickEvent(e)}componentWillUpdate(t){var e;return null!==t.onClick&&null!==t.buttonId&&(null===(e=this._buttonElement)||void 0===e||e.removeEventListener("click",t.onClick)),!0}render(){return'\n      <button\n         id="{{ buttonId }}"\n         className="{{ classNames }}" \n         data-submit="{{ isSubmit }}"\n      > \n        {{ textContent }}\n      </button>\n    '}}q.defaultProps={textContent:"Уппс, забыли установить текст кнопке :)",isSubmit:!1,attrs:"",classNames:"",onClick:null,buttonId:null};class W extends _{constructor(t,e){super(Object.assign(Object.assign({},W.defaultProps),t),e)}render(){const t='\n        <input id="{{ id }}" name="{{ name }}" value="{{ value }}" type="{{ type }}" class="{{ classNames }}" placeholder="{{ placeholder }}" />\n    ';return this.props.withValidation?t+'<span class="{{ name }}__{{ validationClassName }} {{ validationClassName }}"></span>':t}}W.defaultProps={type:"text",classNames:"",name:"",placeholder:"",value:"",withValidation:!1,validationClassName:"text-error",id:""};class G extends _{constructor(t,e){super(Object.assign(Object.assign({},G.defaultProps),t),e)}render(){const t='<textarea class="{{ classNames }}" name="{{ name }}"></textarea>';return this.props.withValidation?t+'<span class="{{ name }}__{{ validationClassName }} {{ validationClassName }}"></span>':t}}G.defaultProps={classNames:"",name:"",value:"value",withValidation:!1,validationClassName:"text-error"};class H{constructor(t,e,n,s){this.classes={menuButtonClass:t,backdropClass:e,navClass:n,closeButtonClass:s},this.menuButton=document.querySelector("."+t),this.backdrop=document.querySelector("."+e),this.nav=document.querySelector("."+n),this.closeButton=document.querySelector("."+s),this.menuButton&&this.backdrop&&this.nav&&this.closeButton?this.isLoading=!0:this.isLoading=!1,this.closeNavAndButton=this.closeNavAndButton.bind(this),this.openNavAndButton=this.openNavAndButton.bind(this)}init(){this.isLoading&&(this.addListener(this.closeButton,"click",this.closeNavAndButton),this.addListener(this.backdrop,"click",this.closeNavAndButton),this.addListener(this.menuButton,"click",this.openNavAndButton))}destroy(){var t,e,n;null===(t=this.closeButton)||void 0===t||t.removeEventListener("click",this.closeNavAndButton),null===(e=this.backdrop)||void 0===e||e.removeEventListener("click",this.closeNavAndButton),null===(n=this.menuButton)||void 0===n||n.removeEventListener("click",this.openNavAndButton)}addListener(t,e,n){t.addEventListener("click",n)}closeNavAndButton(){var t,e,n;null===(t=this.nav)||void 0===t||t.classList.remove(this.classes.navClass+"_open"),null===(e=this.backdrop)||void 0===e||e.classList.remove(this.classes.backdropClass+"_open"),null===(n=this.closeButton)||void 0===n||n.classList.remove(this.classes.closeButtonClass+"_open")}openNavAndButton(){var t,e,n;null===(t=this.nav)||void 0===t||t.classList.add(this.classes.navClass+"_open"),null===(e=this.backdrop)||void 0===e||e.classList.add(this.classes.backdropClass+"_open"),null===(n=this.closeButton)||void 0===n||n.classList.add(this.classes.closeButtonClass+"_open")}}const K=["a","b","c","d","f","e","g","h","k","l"];function z(){const t=[],e=(Math.trunc(1e9*Math.random())+987654321)%1e9;for(const n of String(e)+String(Date.now()))Math.random()<=.75&&t.push(K[Number(n)]);return"id_"+t.join("")}class V extends _{constructor(t,e){super(Object.assign(Object.assign({},V.defaultProps),t),e),this._menu=null,this._id=z()}componentDidMount(){this.initializeMenu()}componentWillUpdate(){return this._menu&&this._menu.destroy(),!0}componentDidUpdate(){this._menu&&this._menu.destroy(),this.initializeMenu()}componentWillUnmount(){this._menu&&this._menu.destroy()}initializeMenu(){this._menu=new H("contacts-controls__menu","backdrop","left-menu","close-button"),this._menu.init()}render(){let{userAvatar:t,userName:e,userSurname:n}=this.props;const s=C.getUser();s&&(t=s.avatar,e=r(e)?"[Укажите имя]":e,n=r(n)?"[Укажите фамилию]":n);let o='<div class="account__avatar-menu"></div>';return t&&!r(t)&&(o=`<div \n                  class="account__avatar-menu" \n                  style="background-image: url('https://ya-praktikum.tech${t}')"\n                 ></div>`),` \n      <nav class="left-menu">\n        <Button\n          classNames="left-menu__close-button close-button"\n          textContent="**closeButtonContent**"\n        /> \n        \n        <header class="left-menu__account account">\n          <div class="account__container">\n            ${o}\n            <div class="account__name-block">\n              <span>${e}</span>\n              <span>${n}</span>\n            </div>\n          </div>\n        </header>\n    \n        <section class="left-menu__navigation">\n          <ul class="messenger-navigation">\n            <ItemList\n              menuList="**menuList**" \n            />\n          </ul>\n    \n          <footer class="left-menu__footer">\n            <RouterComponent\n              linkText="Выйти"\n              page="{{ logoutUrl }}"\n            />\n          </footer>\n        </section>\n      </nav>\n    \n      <div class="backdrop"></div>\n    `}}V.defaultProps={logoutUrl:"/logout",menuList:[],userName:"",userSurname:"",userAvatar:"",closeButtonContent:'<i class="fa fa-times"></i>'};class J extends _{constructor(t,e){super(Object.assign(Object.assign({},J.defaultProps),t),e)}render(){if(!this.props.hasOwnProperty("menuList")||!Array.isArray(this.props.menuList))return"";const{menuList:t}=this.props;return t.map(({text:t,url:e})=>`\n                <li class="messenger-navigation__element">\n                    <RouterComponent\n                      linkText="${t}"\n                      router="**router**"\n                      page="${e}"\n                    />\n                </li>`).join("")}}J.defaultProps={menuList:[],router:c};const Z=["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4caf50","#ff9800","#ff5722","#795548","#607d8b"];class Y extends _{constructor(t,e){super(Object.assign(Object.assign({},Y.defaultProps),t),e),this.onChatClickEvent=this.onChatClickEvent.bind(this)}componentDidMount(){this.registerGoToMessageEvent()}componentWillUpdate(){return this.destroyGoToMessageEvent(),!0}componentDidUpdate(){this.destroyGoToMessageEvent(),this.registerGoToMessageEvent()}componentWillUnmount(){this.destroyGoToMessageEvent()}registerGoToMessageEvent(){const t=document.querySelectorAll(".go-to-chat-element");if(0!==t.length)for(const e of t)e.addEventListener("click",this.onChatClickEvent)}destroyGoToMessageEvent(){const t=document.querySelectorAll(".go-to-chat-element");if(0!==t.length)for(const e of t)e.removeEventListener("click",this.onChatClickEvent)}onChatClickEvent(t){if(!t.target)return;const e=t=>{if([...t.classList.values()].filter(t=>"go-to-chat-element"===t).length)return t;const n=t.parentElement;return n?e(n):null},n=e(t.target);if(!n)return;const s=n.getAttribute("data-chat-id");s&&c.go("/chat/{:chatId}",{chatId:s,chatOpen:!0})}render(){var t;let{contactsList:e}=this.props;const{isLoading:n}=this.props;0===e.length&&(e=null!==(t=P.getChats())&&void 0!==t?t:[]);let s=n?'<li class="contacts__loading"><Spinner /></li>':e.map(t=>{let e=0;const n=Math.trunc(t.title.split("").reduce((t,n)=>(e+=1,t+n.charCodeAt(0)*e+e),1));return`\n        <li class="person contacts__element go-to-chat-element" data-chat-id="${t.id}">\n          <div>\n            <div style="background-color: ${Z[n%Z.length]}" class="person__avatar">${t.title[0]}</div>\n          </div>\n          <div class="person__information">\n            <header class="person__header">\n              <h6 class="person__name">${t.title}</h6>\n              \n              <small class="person__last-messege-date">Новых сообщений: ${t.unreadMessage}</small>\n            </header>\n            <p class="person__last-messege">\n              Перейти в чат\n            </p>\n          </div>\n        </li>\n      `}).join("");r(s)&&(s='<li class="contacts__loading">Чатов пока нет :(</li>');let o='<li class="create-chat">\n          <BaseInput\n            type="text"\n            placeholder="Название чата..."\n            name="chat-name"\n            classNames="create-chat__input"\n            id="{{ createChatInputId }}"\n          />\n         \n          <Button\n            textContent="Создать чат"\n            classNames="create-chat__button"\n            buttonId="{{ createChatId }}"\n          />\n        </li>';return n&&(o=""),`\n      <ul class="contacts__list">\n        ${o}\n        ${s}  \n      </ul>\n    `}}Y.defaultProps={isLoading:!1,createChatId:"",createChatInputId:"",contactsList:[]};class X extends _{constructor(t={},e){super(Object.assign(Object.assign({},X.defaultProps),t),e)}render(){return'\n      <section class="conversation">\n         <div class="choose-chat conversation__choose-chat">\n           <h5 class="choose-chat__title">Выберите собеседника</h5>\n         </div>\n      </section>\n    '}}X.defaultProps={};class Q extends _{constructor(t,e){super(Object.assign(Object.assign({},Q.defaultProps),t),e)}render(){return'\n    <form class="{{ formClassName }}">\n      <div class="authentication__inputs">\n        <BaseInput\n          classNames="base-input"\n          name="login"\n          type="text"\n          placeholder="Ваш логин"\n          withValidation="true"\n        />\n\n        <BaseInput\n          classNames="base-input"\n          name="password"\n          type="password"\n          placeholder="Ваш пароль"\n          withValidation="true"\n        />\n\n        <span class="default__text-error text-error" style="padding-bottom: 0"></span>\n      </div>\n\n      <footer class="authentication__buttons data_controls">\n        <RouterComponent\n          linkText="Регистрация"\n          page="{{ registerRoute }}"\n          classNames="data_controls__parallel"\n        />\n        <Button\n          textContent="Войти"\n          classNames="data-controls__button data-controls__button_type_submit"\n          isSubmit="true"\n        />\n      </footer>\n    </form>\n    '}}Q.defaultProps={formClassName:"",registerRoute:"/register"};class tt extends _{constructor(t,e){super(Object.assign(Object.assign({},tt.defaultProps),t),e)}render(){return'\n      <form class="{{ formClassName }} authentication__form">\n        <div class="authentication__inputs">\n           <BaseInput\n            classNames="base-input"\n            name="login"\n            type="text"\n            placeholder="Придумайте логин"\n            withValidation="true"\n          />\n\n          <BaseInput\n            classNames="base-input"\n            name="email"\n            type="email"\n            placeholder="Ваш email"\n            withValidation="true"\n          />\n\n          <BaseInput\n            classNames="base-input"\n            name="phone"\n            type="phone"\n            placeholder="Ваш телефон"\n            withValidation="true"\n          />\n\n          <BaseInput\n            classNames="base-input"\n            name="password"\n            type="password"\n            placeholder="Ваш пароль"\n            withValidation="true"\n          />\n\n          <span class="default__text-error text-error" style="padding-bottom: 0"></span>\n        </div>\n\n        <footer class="authentication__buttons data_controls">\n          <RouterComponent\n            linkText="Авторизация"\n            page="{{ loginRoute }}"\n            classNames="data_controls__parallel"\n          />\n          <Button\n            textContent="Зарегистрироваться"\n            classNames="data-controls__button data-controls__button_type_submit"\n            isSubmit="true"\n          />\n        </footer>\n      </form>\n    '}}tt.defaultProps={formClassName:"registration-form",loginRoute:"/login"};class et extends _{constructor(t,e){super(Object.assign(Object.assign({},et.defaultProps),t),e)}render(){let t='<div class="avatar-container__image"></div>';return this.props.userAvatar&&!r(this.props.userAvatar)&&(t=`<div\n                  class="avatar-container__image"\n                  style="background-image: url('https://ya-praktikum.tech/${this.props.userAvatar}')"\n                 ></div>`),`\n      <form class="{{ formClassName }}">\n        <div class="settings__account account">\n          <div class="account__container">\n            ${t}\n            <div class="account__name">\n              <BaseInput\n                classNames="account__input"\n                name="name"\n                value="{{ userName }}"\n                placeholder="Введите Ваше имя"\n                withValidation="true"\n              />\n              <BaseInput\n                classNames="account__input"\n                name="surname"\n                value="{{ userSurname }}"\n                placeholder="Введите Вашу Фамилию"\n                withValidation="true"\n              />\n            </div>\n          </div>\n        </div>\n\n        <div class="settings__avatar-changer">\n          <ChangeAvatarForm\n            formClassName="{{ changeAvatarFormName }}"\n            inputName="{{ changeAvatarInputName }}"\n          />\n        </div>\n\n        <div class="settings__bio-control bio-control">\n          <div class="bio-control__container">\n            <p class="bio-control__title">\n              Ваш никнейм в чате (если не задан, будет использован логин):\n            </p>\n            <BaseInput\n              type="text"\n              name="displayName"\n              classNames="base-input"\n              value="{{ userDisplayName }}"\n              withValidation="true"\n            />\n          </div>\n        </div>\n\n        <div class="settings__password-control password-control">\n          <div class="password-control__container">\n            <BaseInput\n                classNames="base-input"\n                name="oldPassword"\n                type="password"\n                placeholder="Старый пароль"\n                withValidation="true"\n            />\n            <BaseInput\n              classNames="base-input"\n              name="newPassword"\n              type="password"\n              placeholder="Новый пароль"\n              withValidation="true"\n            />\n          </div>\n\n           <span class="default__text-error text-error" style="padding-bottom: 0"></span>\n        </div>\n\n        <footer class="settings__footer data-controls">\n          <RouterComponent\n            classNames="data-controls__button data-controls__button_type_cancel"\n            linkText="Отменить и выйти"\n            page="/"\n          />\n          <Button\n            classNames="data-controls__button data-controls__button_type_submit"\n            textContent="Сохранить"\n            buttonId="settingSubmit"\n            isSubmit="true"\n          />\n        </footer>\n      </form>\n    `}}et.defaultProps={userDisplayName:"",userName:"",userSurname:"",userAvatar:"",formClassName:"settings-form",stopPropagation:t=>{t.stopPropagation(),t.preventDefault()},changeAvatarFormName:"changeAvatarForm",changeAvatarInputName:"avatar"};class nt extends _{constructor(t,e){super(Object.assign(Object.assign({},nt.defaultProps),t),e),this.goToComp=this.goToComp.bind(this)}addListener(){this.routeId&&(this._link=document.getElementById(this.routeId),this._link&&this._link.addEventListener("click",this.goToComp))}removeListener(){this._link&&this._link.removeEventListener("click",this.goToComp)}goToComp(t){t.preventDefault(),t.stopPropagation();const e=this.props.router;if(!e)throw Error("incorrect router in RouterComponent");e.go("/"+this.props.page)}componentDidMount(){this.addListener()}componentWillUpdate(){return this.removeListener(),!0}componentDidUpdate(){this.removeListener(),this.addListener()}componentWillUnmount(){this.removeListener()}render(){return this.routeId=z(),`\n      <a className="{{ classNames }}" id="${this.routeId}" href=''>{{ linkText }}</a>\n    `}}nt.defaultProps={linkText:"На главную",page:"/",router:c,classNames:""};class st extends _{constructor(t,e){super(Object.assign(Object.assign({},st.defaultProps),t),e)}render(){return'\n      <form class="{{ formClassName }}" enctype="multipart/form-data">\n        <div style="display: flex; justify-content: space-between; align-items: center;">\n          <BaseInput\n            classNames="data-controls__file-input"\n            name="{{ inputName }}"\n            type="file"\n            placeholder="Выберите картинку"\n          />\n          <Button\n            textContent="Сменить"\n            classNames="data-controls__button data-controls__button_type_submit"\n            isSubmit="true"\n          />\n        </div>\n        <div>\n            <span class="avatar__text-error text-error" style="padding-bottom: 0"></span>\n        </div>\n      </form>\n    '}}st.defaultProps={formClassName:"changeAvatarForm",inputName:"avatar"};const rt=[{name:"Button",value:q},{name:"BaseInput",value:W},{name:"BaseTextarea",value:G},{name:"Menu",value:V},{name:"ItemList",value:J},{name:"ContactSearch",value:class extends _{render(){return'\n      <header class="contacts-controls">\n        <span class="contacts-controls__menu" title="Меню">\n          <i class="fa fa-bars"></i>\n        </span>\n        <form class="contacts-controls__search-form">\n          <BaseInput\n            classNames="contacts-controls__search" \n            type="text"\n            name="contacts_search"\n            placeholder="Поиск по контактам"\n          />\n        </form> \n      </header>\n    '}}},{name:"ContactsList",value:Y},{name:"Conversation",value:X},{name:"LoginForm",value:Q},{name:"RegisterForm",value:tt},{name:"SettingsForm",value:et},{name:"RouterComponent",value:nt},{name:"ChangeAvatarForm",value:st},{name:"Spinner",value:class extends _{render(){return'<div class="loadingio-spinner-spinner-jn4kciuenz">\n              <div class="ldio-yxl3ek1zkmn">\n                <div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div>\n              </div>\n            </div>'}}}];class ot{constructor(t,e){this.formElement=t,this.fields=e,this.subscribers=[],this.subscribersOnFocus=[],this.subscribersOnBlur=[],this._eventSubmitFunction=this._eventSubmitFunction.bind(this),this._eventFocusFunction=this._eventFocusFunction.bind(this),this._eventBlurFunction=this._eventBlurFunction.bind(this),this.subscribers=[],this.subscribersOnFocus=[],this.subscribersOnBlur=[]}destroy(){this.formElement.removeEventListener("submit",this._eventSubmitFunction),this.fields.forEach(t=>{this.formElement[t].removeEventListener("focus",this._eventFocusFunction),this.formElement[t].removeEventListener("blur",this._eventBlurFunction)})}init(t="submit"){switch(t){case"submit":default:this.formElement.addEventListener(t,this._eventSubmitFunction)}return this._focus(),this._blur(),this}_focus(){return this.fields.forEach(t=>{this.formElement[t].addEventListener("focus",this._eventFocusFunction)}),this}_blur(){return this.fields.forEach(t=>{this.formElement[t].addEventListener("blur",this._eventBlurFunction)}),this}_eventBlurFunction(t){this.emitAllOnBlur(t)}_eventFocusFunction(t){this.emitAllOnFocus(t)}_eventSubmitFunction(t){t.preventDefault();const e=t.target;if(null===e)return;const n={};this.fields.forEach(t=>{n[t]=e[t].value}),this.emitAll(n)}emitAll(t){this.subscribers.forEach(e=>e(t,this.formElement))}emitAllOnBlur(t){this.subscribersOnBlur.forEach(e=>e(t,this.formElement))}emitAllOnFocus(t){this.subscribersOnFocus.forEach(e=>e(t,this.formElement))}subscribe(t){return this.subscribers.push(t),this}subscribeSubmit(t){return this.subscribers.push(t),this}subscribeOnFocus(t){return this.subscribersOnFocus.push(t),this}subscribeOnBlur(t){return this.subscribersOnBlur.push(t),this}unsubscribe(t){return this.subscribers=this.subscribers.filter(e=>e!==t),this.subscribersOnBlur=this.subscribersOnBlur.filter(e=>e!==t),this.subscribersOnFocus=this.subscribersOnFocus.filter(e=>e!==t),this}}function at(t,e,n=null){for(const s of t.querySelectorAll("."+e))(null===n||s&&[...s.classList].join("").includes(n+"__text-error"))&&(s.textContent="")}function it(t,e,n=!0){const s=Object.entries(t);n&&at(e,"text-error");for(const[t,n]of s){const s=e.querySelector(`.${t}__text-error`);s&&(s.textContent=n)}}function lt(t,e){const n=e.target;if(null===n)return;const s=n.form;if(!s)return;const r=t({[n.name]:n.value});r.hasError?it(r.errors,s,!1):at(s,"text-error",n.name)}class ct{constructor(t,e,n,s,r,o){this.name=t,this.surname=e,this.displayName=n,this.login=s,this.email=r,this.phone=o}async perform(){try{const t=await(new T).put(L.UPDATE_USER.url,{method:L.UPDATE_USER.method,data:{first_name:this.name,second_name:this.surname,display_name:this.displayName,login:this.login,email:this.email,phone:this.phone}});if(t.status>=400){return{state:!1,errors:[{message:JSON.parse(t.response).reason}]}}const e=JSON.parse(t.response);if(!e)throw Error("parse error in UpdateUser");return{state:!0,errors:[],user:{name:e.first_name,surname:e.second_name,displayName:e.display_name,phone:e.phone,email:e.email,login:e.login,id:e.id,avatar:e.avatar}}}catch(t){return console.log(t),{state:!1,errors:[{field:"default",message:"Уууппсс, что-то пошло не так"}]}}}}class ut{constructor(t,e){this.oldPassword=t,this.newPassword=e}async perform(){try{const t=await(new T).put(L.UPDATE_PASSWORD.url,{method:L.UPDATE_PASSWORD.method,data:{oldPassword:this.oldPassword,newPassword:this.newPassword}});return t.status>=400?{state:!1,errors:[{message:t.response}]}:{state:!0,errors:[]}}catch(t){return console.log(t),{state:!1,errors:[{message:"Упппс, что-то пошло не так"}]}}}}async function ht(t,e){try{const n=M(t);if(n.hasError)throw{errors:n.errors,formElement:e};at(e,"text-error");const s={userName:t.name,userSurname:t.surname,userDisplayName:t.displayName},o={oldPassword:t.oldPassword,newPassword:t.newPassword};if(o.oldPassword&&(!o.newPassword||r(o.newPassword)))throw{errors:{newPassword:"Придумайте новый пароль"}};if(o.newPassword&&(!o.oldPassword||r(o.oldPassword)))throw{errors:{oldPassword:"Укажите ваш текущий пароль"}};const a=C.getUser();if(!a)throw{errors:{default:"Произошла ошибка :( "}};const i=await new ct(s.userName,s.userSurname,s.userDisplayName,a.login,a.email,a.phone).perform();if(!i.state){throw{errors:x(i.errors)}}const l=i.user;if(l&&C.authorize(l),o.oldPassword&&o.newPassword){const t=await new ut(o.oldPassword,o.newPassword).perform();if(!t.state){throw{errors:x(t.errors)}}window&&window.alert&&window.alert("Пожалуйста, авторизируйтесь с новым паролем"),c.go("/logout")}window&&window.alert&&window.alert("Данные обновленны")}catch(t){it(t.errors,e),console.log(t)}}class dt{async perform(){try{const t=await(new T).get(L.CHECK_AUTH.url);if(t.status>=400)return null;const e=JSON.parse(t.response);return e?{id:parseInt(e.id),login:e.login,phone:e.phone,name:e.first_name,surname:e.second_name,email:e.email,avatar:e.avatar,displayName:e.display_name}:null}catch(t){return console.log(t),null}}}class mt{constructor(t){this.formData=t}async perform(){try{const t=await(new T).put(L.UPDATE_AVATAR.url,{isFormData:!0,data:this.formData});if(t.status>=400)return{state:!1,errors:[{message:t.response,field:"avatar"}]};const e=JSON.parse(t.response);if(!e)throw Error("parse error in UpdateUser");return{state:!0,errors:[],user:{name:e.first_name,surname:e.second_name,displayName:e.display_name,phone:e.phone,email:e.email,login:e.login,id:e.id,avatar:e.avatar}}}catch(t){return console.log(t),{state:!1,errors:[{field:"avatar",message:"Слишком большой размер картинки или неверный формат :( "}]}}}}var pt,vt,gt,ft;class _t extends _{constructor(t={},e){super(Object.assign(_t.defaultProps,t),e),this._formControl=null,this.updateAvatar=this.updateAvatar.bind(this)}componentDidMount(){this.initFormControl(),this.initUpdateAvatarControl(),(new dt).perform().then(t=>{t&&this.setProps({userName:t.name,userSurname:t.surname,userDisplayName:t.displayName,userAvatar:t.avatar})})}updateAvatar(t){(async function(t){const e=t.target;if(!e)return!1;try{t.preventDefault(),t.stopPropagation();const n=new FormData(e),s=await new mt(n).perform();if(!s.state){throw{errors:x(s.errors)}}const r=s.user;return r&&C.authorize(r),!0}catch(t){return it(t.errors,e),!1}})(t).then(t=>{var e;t&&this.setProps({userAvatar:null===(e=C.getUser())||void 0===e?void 0:e.avatar})})}initFormControl(){const t=document.querySelector(".settings-form");null!==t&&(this._formControl=new ot(t,["name","surname","displayName","oldPassword","newPassword"]).init(),this._formControl.subscribe(ht),this._formControl.subscribeOnBlur(lt.bind(null,M)),this._formControl.subscribeOnFocus(lt.bind(null,M)))}initUpdateAvatarControl(){const t=document.querySelector(".changeAvatarForm");t&&t.addEventListener("submit",this.updateAvatar)}destroyAvatarControl(){const t=document.querySelector(".changeAvatarForm");t&&t.removeEventListener("submit",this.updateAvatar)}destroyFormControl(){null!==this._formControl&&(this._formControl.destroy(),this.initFormControl())}componentWillUpdate(){return this.destroyFormControl(),this.destroyAvatarControl(),this.initUpdateAvatarControl(),!0}componentWillUnmount(){this.destroyFormControl(),this.destroyAvatarControl()}render(){return'\n      <section class="settings messenger__settings">\n        <div class="settings__container">\n          <header class="settings__header"> \n          <h5 class="settings__title">Настройки</h5>\n          <RouterComponent \n            classNames="settings__close-button close-button" \n            page="/"\n            linkText="**buttonText**"\n          />\n          </header>\n          <SettingsForm \n            formClassName="settings-form"\n            userName="{{ userName }}"\n            userSurname="{{ userSurname }}"\n            userDisplayName="{{ userDisplayName }}"\n            userAvatar="{{ userAvatar }}"\n            \n            changeAvatarFormName="changeAvatarForm"\n            changeAvatarInputName="avatar"\n          /> \n        </div>\n      </section>\n    '}}_t.defaultProps={buttonText:'<i title="Закрыть" class="fa fa-times"></i>',userName:null===(pt=C.getUser())||void 0===pt?void 0:pt.name,userSurname:null===(vt=C.getUser())||void 0===vt?void 0:vt.surname,userDisplayName:null===(gt=C.getUser())||void 0===gt?void 0:gt.displayName,userAvatar:null===(ft=C.getUser())||void 0===ft?void 0:ft.avatar};class bt{constructor(t,e){this.login=t,this.password=e}async perform(){try{const t=await(new T).post(L.AUTHORIZATION.url,{method:L.AUTHORIZATION.method,data:{login:this.login,password:this.password}});if(t.status>=400){return{state:!1,errors:[{message:JSON.parse(t.response).reason}]}}return{state:!0,errors:[]}}catch(t){return console.log(t),{state:!1,errors:[{field:"default",message:"Уууппсс, что-то пошло не так"}]}}}}async function Ct(t,e){try{const n=M(t);if(n.hasError)throw{errors:n.errors,formElement:e};at(e,"text-error");const s=await new bt(t.login,t.password).perform();if(!s.state){throw{errors:x(s.errors)}}const r=await(new dt).perform();if(!r)throw{errors:{default:"Сервер не отвечает :("}};C.authorize(r),c.go("/")}catch(t){console.log(t),it(t.errors,e)}}class yt{constructor(t,e,n,s){this.login=t,this.email=e,this.password=n,this.phone=s}async perform(){try{const t=await(new T).post(L.REGISTRATION.url,{method:L.REGISTRATION.method,data:{login:this.login,email:this.email,phone:this.phone,password:this.password,first_name:"",second_name:""}});if(t.status>=400){return{state:!1,errors:[{message:JSON.parse(t.response).reason}]}}const e=await(new dt).perform();return e?{state:!0,user:e,errors:[]}:{state:!0,user:{id:0,login:this.login,email:this.email,name:"",surname:"",phone:""},errors:[]}}catch(t){return console.log("Error in api => ",t),{state:!1,errors:[{message:"Упппс, что-то пошло не так, попробуйте еще раз",field:"password"}]}}}}async function wt(t,e){try{const n=M(t);if(n.hasError)throw{errors:n.errors,formElement:e};at(e,"text-error");const s=t,r=await new yt(s.login,s.email,s.password,s.phone).perform();if(!r.state||!r.user){throw{errors:x(r.errors)}}const o=r.user;C.authorize(o),c.go("/")}catch(t){it(t.errors,e)}}class Et extends _{constructor(t={},e=[]){super(Object.assign(Object.assign({},Et.defaultProps),t),e)}render(){return'\n      <section class="error messenger__error">\n        <div class="error_container">\n          <header class="error__code">\n            <span class="error__code-title">{{ errorCode }}</span>\n          </header>\n          <div class="error__message">\n            <p class="error__message-text">\n              {{ errorMessage }}\n            </p>\n          </div>\n          <footer class="error__links">\n            <RouterComponent\n              linkText="На главную"\n              page="/"\n            />\n          </footer>\n        </div>\n      </section>\n    '}}Et.defaultProps={errorCode:"404",errorMessage:"Такой страницы не <br /> существует :(",route:""};class Nt{constructor(){this.middlewares=[],this.route="/404"}setRoute(t){return this.route=t,this}addMiddleware(t){return this.middlewares.push(t),this}async process(){for(const t of this.middlewares){const e=await t.check();if(!e)return{state:e,route:this.route}}return{state:!0,route:""}}}class Tt{constructor(t=!1){this.reverse=t}async check(){try{if(!C.getUser())return this.reverse;return null===await(new dt).perform()?this.reverse:!this.reverse}catch(t){return console.log(t),this.reverse}}}class At{async perform(){try{C.removeUser(),await(new T).post(L.LOGOUT.url)}catch(t){console.log(t)}}}class Lt{constructor(t){this.chatId=t}async perform(){try{const t=await(new T).get(L.GET_CHAT_USERS.urlTemplate?L.GET_CHAT_USERS.urlTemplate(this.chatId):L.GET_CHAT_USERS.url);if(t.status>=400)return{state:!1,errors:[{message:t.response}]};const e=JSON.parse(t.response);if(!e)throw Error("JSON parse error");return{users:e.map(t=>({id:parseInt(t.id),login:t.login,phone:t.phone,name:t.first_name,surname:t.second_name,email:t.email,avatar:t.avatar,displayName:t.display_name})),state:!0,errors:[]}}catch(t){return console.log(t),{state:!1,errors:[{message:"Уппс, что-то опять пошло не так :("}]}}}}class Ot{constructor(t){this.chatId=t}async perform(){let t=P.getChats();if(!t){const e=await(new S).perform();if(!e.state||!e.chats)return{state:!1,errors:e.errors};t=e.chats}const e=t.filter(t=>Number(t.id)===Number(this.chatId)).pop();if(!e)return{state:!1,errors:[{message:`Чата с номером #${this.chatId} не существует`}]};const n=await new Lt(e.id).perform();return n.state&&n.users?(e.users=n.users,{state:!0,chat:e,errors:[]}):{state:!1,errors:n.errors}}}class St{static addConversation(t){b.saveItemByKey(St.conversationStorageKey,JSON.stringify(t))}static cleanConversation(){b.removeItemByKey(St.conversationStorageKey)}static getConversation(){return b.getObjectByKey(St.conversationStorageKey)}}St.conversationStorageKey="active_chat";class xt{constructor(t,e){this.chatId=t,this.usersId=e}async perform(){try{const t=await(new T).delete(L.DELETE_USER_FROM_CHAT.url,{method:L.DELETE_USER_FROM_CHAT.method,data:{chatId:this.chatId,users:this.usersId}});return t.status>=400?{state:!1,errors:[{message:t.response}]}:{state:!0,errors:[]}}catch(t){return console.log(t),{state:!1,errors:[{message:"Уууппс, что-то пошло не так :( "}]}}}}class Pt{constructor(t,e){this.chatId=t,this.usersId=e}async perform(){try{const t=await(new T).put(L.ADD_USER_IN_CHAT.url,{method:L.ADD_USER_IN_CHAT.method,data:{chatId:this.chatId,users:this.usersId}});return t.status>=400?{state:!1,errors:[{message:t.response}]}:{state:!0,errors:[]}}catch(t){return console.log(t),{state:!1,errors:[{message:"Уууппс, что-то пошло не так :( "}]}}}}class It{constructor(t){this.userLogin=t}async perform(){try{const t=await(new T).post(L.FIND_USER_BY_LOGIN.url,{method:L.FIND_USER_BY_LOGIN.method,data:{login:this.userLogin}});if(t.status>=400)return{state:!0,errors:[],user:null};const e=JSON.parse(t.response);return Array.isArray(e)?{state:!0,errors:[],user:e.pop()}:{state:!0,errors:[],user:null}}catch(t){return console.log(t),{state:!1,errors:[]}}}}class Ut extends _{constructor(t={},e){super(Object.assign(Object.assign({},Ut.defaultProps),t),e),this.onRemoveUserInChatClick=this.onRemoveUserInChatClick.bind(this),this.onAddUserInChatClick=this.onAddUserInChatClick.bind(this)}componentDidMount(){this.updateChat()}componentWillUpdate(){return this.destroyRemoveUserEvent(),this.destroyAddUserEvent(),!0}componentDidUpdate(){this.destroyRemoveUserEvent(),this.destroyAddUserEvent(),this.registerRemoveUserEvent(),this.registerAddUserEvent()}componentWillUnmount(){this.destroyRemoveUserEvent(),this.destroyAddUserEvent()}registerRemoveUserEvent(){const t=document.querySelectorAll(".delete-user-in-chat");if(t&&0!==t.length)for(const e of t)e.addEventListener("click",this.onRemoveUserInChatClick)}registerAddUserEvent(){const t=document.querySelector("#add-user-button");t&&t.addEventListener("click",this.onAddUserInChatClick)}destroyAddUserEvent(){const t=document.querySelector("#add-user-button");t&&t.removeEventListener("click",this.onAddUserInChatClick)}destroyRemoveUserEvent(){const t=document.querySelectorAll(".delete-user-in-chat");if(t&&0!==t.length)for(const e of t)e.removeEventListener("click",this.onRemoveUserInChatClick)}onAddUserInChatClick(){const t=document.querySelector("#chat-user-login-input");if(!t)return;const e=M({userLogin:t.value});e.hasError?Object.keys(e.errors).forEach(t=>{alert(e.errors[t])}):(this.setProps({isLoading:!0}),new It(t.value).perform().then(t=>{if(t.state){const e=t.user,{chatId:n}=this.props;e&&n?new Pt(n,[e.id]).perform().then(t=>{t.state?this.updateChat():this.setProps({isLoading:!1})}):this.setProps({isLoading:!1})}}))}onRemoveUserInChatClick(t){const e=t.target.getAttribute("data-user-id"),{chatId:n}=this.props;e&&n&&(this.setProps({isLoading:!0}),new xt(n,[parseInt(e)]).perform().then(t=>{console.log(t),t.state&&this.updateChat()}))}updateChat(){const{chatId:t}=this.props;t&&async function(t){try{const e=await new Ot(t).perform();if(!e.state)throw x(e.errors);return{state:!0,chat:e.chat}}catch(t){return Object.keys(t).forEach(e=>{"No chat"===t[e]?alert("Чат удален"):alert(t[e])}),{state:!1}}}(t).then(t=>{t.state?t.chat&&(St.addConversation(t.chat),this.setProps({chat:t.chat,isLoading:!1})):c.go("/")})}render(){const{isLoading:t,chat:e}=this.props;let n="",s="";if(t||!e)n='\n        <section class="conversation conversation__full">\n          <Spinner />\n        </section>\n      ',s='<div class="interlocutor__person-container">\n          <div class="interlocutor__back-button">\n            <RouterComponent\n            page="/"\n            linkText="**backLinkText**"\n            />\n          </div>\n          <div class="interlocutor__person-status"></div>\n          <div class="interlocutor__person-name">Загрузка...</div>\n        </div>\n        <div class="interlocutor__open-users-chat open-users-chat">Пользователи чата</div>';else{n=`\n        <ul class="contacts__list">\n          <li class="add-user-in-chat">\n            <BaseInput\n              type="text"\n              placeholder="Логин пользователя..."\n              name="user-login"\n              classNames="create-chat__input"\n              id="chat-user-login-input"\n            />\n            \n            <Button\n              textContent="Добавить"\n              classNames="create-chat__button"\n              buttonId="add-user-button"\n            />\n          </li>\n          \n          ${e.users.map(t=>{var e,n,s;let o=r(t.displayName)?null:null===(e=t.displayName)||void 0===e?void 0:e.trim();return o||(o=`${null!==(n=t.name)&&void 0!==n?n:""} ${null!==(s=t.surname)&&void 0!==s?s:""}`),o.trim().length<=2&&(o=t.login),`\n            <li class="person contacts__element" >\n              <div>\n                <div style="background-color: cadetblue" class="person__avatar">${o[0]}</div>\n              </div>\n              <div class="person__information">\n                <header class="person__header">\n                  <h6 class="person__name">${o}</h6>\n                </header>\n                <p class="person__last-messege delete-user-in-chat" data-user-id="${t.id}">\n                  Удалить пользователя из чата\n                </p>\n              </div>\n            </li>\n        `}).join("")}\n        </ul>\n      `,s=`\n         <div class="interlocutor__person-container">\n          <div class="interlocutor__back-button">\n            <RouterComponent\n            page="/"\n            linkText="**backLinkText**"\n            />\n          </div>\n          <div class="interlocutor__person-status"></div>\n          <div class="interlocutor__person-name">${e.title} <br />Пользователей в чате: ${e.users.length}</div>\n        </div>\n        <div class="interlocutor__open-users-chat open-users-chat">Пользователи чата</div>\n      `}return console.log("--- GroupChat render ---"),`\n        <section class="conversation">\n          <header class="interlocutor">\n            <div class="interlocutor__person">\n              ${s}\n            </div>\n          </header>\n          \n          <div class="messages">\n            <div class="messages__black-container"> \n              Упппссс, в данный момент <br />\n              процесс общения не реализован :(\n            </div>\n          </div>\n        </section>\n        \n        <section class="right-aside">\n          <div class="contacts">\n            ${n}\n          </div>\n        </section>\n    `}}Ut.defaultProps={backLinkText:'<i class="fas fa-long-arrow-alt-left"></i>',isLoading:!0,chatId:null,chat:null};const kt=(new Nt).addMiddleware(new Tt).setRoute("/login"),Bt=(new Nt).addMiddleware(new Tt(!0)).setRoute("/");c.use("/",$,{},rt,[kt]).use("/chat/{:chatId}",Ut,{},rt,[kt]).use("/settings",_t,{},rt,[kt]).use("/login",class extends _{constructor(){super(...arguments),this._formControl=null}componentDidMount(){this.initFormControl()}initFormControl(){const t=document.querySelector(".authentication__form");null!==t&&(this._formControl=new ot(t,["login","password"]).init(),this._formControl.subscribe(Ct),this._formControl.subscribeOnBlur(lt.bind(null,M)),this._formControl.subscribeOnFocus(lt.bind(null,M)))}destroyFormControl(){null!==this._formControl&&(this._formControl.destroy(),this.initFormControl())}componentWillUpdate(){return this.destroyFormControl(),!0}componentWillUnmount(){this.destroyFormControl()}render(){return'\n      <section class="authentication messenger__authentication">\n        <div class="authentication__container">\n          <header class="authentication__header">\n            <h2 class="authentication__title">Авторизация</h2>\n          </header>\n          <LoginForm\n            formClassName="authentication__form"\n          />        \n        </div>\n      </section>\n    '}},{},rt,[Bt]).use("/register",class extends _{constructor(){super(...arguments),this._formControl=null}componentDidMount(){this.initFormControl(),console.log("--- Register did mount ---")}initFormControl(){const t=document.querySelector(".registration-form");null!==t&&(this._formControl=new ot(t,["login","email","phone","password"]).init(),this._formControl.subscribe(wt),this._formControl.subscribeOnBlur(lt.bind(null,M)),this._formControl.subscribeOnFocus(lt.bind(null,M)))}componentWillUpdate(){return console.log("--- Register will update ---"),null!==this._formControl&&this._formControl.destroy(),!0}componentWillUnmount(){console.log("--- Register will Unmount ---"),null!==this._formControl&&this._formControl.destroy()}componentDidUpdate(){console.log("--- Register did Update ---"),null!==this._formControl&&this._formControl.destroy(),this.initFormControl()}render(){return console.log("--- Register render ---"),'\n      <section class="authentication messenger__authentication">\n        <div class="authentication__container">\n          <header class="authentication__header">\n            <h2 class="authentication__title">Регистрация</h2>\n          </header>\n          <RegisterForm\n            formClassName="registration-form"\n          />\n        </div>\n      </section>\n    '}},{},rt,[Bt]).use("/404",Et,{errorCode:404},rt).use("/503",Et,{errorCode:503},rt).use("/logout",class extends _{componentDidMount(){(new At).perform().finally(()=>{c.go("/login")})}render(){return"<section class='authentication messenger__authentication'>Logout...</section>"}},{},rt).useOnError(Et,{errorCode:404},rt).start()}]);